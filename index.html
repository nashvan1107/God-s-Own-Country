<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>God's Own Country</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;0,700;1,400;1,700&family=Montserrat:wght@200;300;400;500;600&family=Great+Vibes&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- NEW: Font Awesome Icons for Social Media -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        :root {
            --kerala-green: #0b3d2e; /* Deep Forest Green */
            --kerala-gold: #c5a059;   /* Muted Luxury Gold */
            --sand: #fdfcf0;          /* Warm Off-White */
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--kerala-green);
            color: var(--sand);
            overflow-x: hidden;
            margin: 0;
        }

        /* Typography Overrides */
        h1, h2, h3, .serif {
            font-family: 'Cormorant Garamond', serif;
        }
        
        .script-font {
            font-family: 'Great Vibes', cursive;
        }

        /* 3D Canvas Background */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: -1;
            background: linear-gradient(to bottom, #051b14, #0b3d2e);
        }

        /* Glassmorphism Classes */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }
        
        .glass-card {
            background: rgba(11, 61, 46, 0.6);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(197, 160, 89, 0.2);
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }
        
        /* 3D Tilt Effect on Hover */
        .district-card {
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .district-card:hover {
            transform: translateY(-10px) rotateX(2deg) rotateY(2deg);
            border-color: var(--kerala-gold);
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        .district-name-art {
            font-family: 'Great Vibes', cursive;
            background: linear-gradient(45deg, #c5a059, #f3e5ab);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        /* Natural Animations */
        .reveal-on-scroll {
            opacity: 0;
            transform: translateY(40px);
            transition: all 1s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        
        .reveal-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Leaf float animation */
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }

        .floating-element {
            animation: float 6s ease-in-out infinite;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #051b14;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--kerala-gold);
            border-radius: 3px;
        }
        
        /* Loader */
        .page-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--kerala-green);
            z-index: 100;
            transform: translateY(100%);
            transition: transform 0.8s cubic-bezier(0.86, 0, 0.07, 1);
        }
        
        .page-transition.active {
            transform: translateY(0%);
        }

        /* View Management */
        .view-section {
            display: none;
            opacity: 0;
            transition: opacity 0.6s ease;
        }
        .view-section.active {
            display: block;
            opacity: 1;
        }

        .gold-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--kerala-gold), transparent);
            width: 100%;
            margin: 2rem 0;
            opacity: 0.5;
        }
        
        /* Star rating input style */
        .rating-group {
            display: flex;
            flex-direction: row-reverse;
            justify-content: center;
        }
        .rating-group > input {
            display: none;
        }
        .rating-group > label {
            cursor: pointer;
            width: 2rem;
            height: 2rem;
            transition: color 0.2s;
        }
        .rating-group > label svg {
            fill: currentColor;
            color: rgba(255, 255, 255, 0.2);
            transition: color 0.2s;
        }
        .rating-group > input:checked ~ label svg,
        .rating-group > label:hover svg,
        .rating-group > label:hover ~ label svg {
            color: var(--kerala-gold);
        }
    </style>
</head>
<body>

    <!-- 3D Background -->
    <div id="canvas-container"></div>
    
    <!-- Page Transition Overlay -->
    <div id="transition-overlay" class="page-transition flex items-center justify-center">
        <div class="text-center">
            <h2 class="text-4xl text-yellow-500 serif italic">Exploring...</h2>
        </div>
    </div>

    <!-- Review Submission Modal -->
    <div id="review-modal" class="hidden fixed inset-0 z-[100] items-center justify-center p-4 bg-black/60 backdrop-blur-md transition duration-300">
        <div class="glass-panel w-full max-w-lg p-8 rounded-xl relative border-yellow-500/30">
            <button onclick="closeReviewModal()" class="absolute top-4 right-4 text-white/50 hover:text-white transition">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <h3 class="text-3xl text-white mb-2 serif">Share Your Experience</h3>
            <p class="text-yellow-500/80 mb-6">Tell us about your time in God's Own Country.</p>
            
            <form id="review-form" onsubmit="event.preventDefault(); submitReview();">
                <div id="message-box" class="hidden"></div>
                
                <!-- Rating -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-white/70 mb-2">Your Rating</label>
                    <div class="rating-group">
                        <input type="radio" id="star5" name="review-rating" value="5" /><label for="star5"><i data-lucide="star" class="w-6 h-6"></i></label>
                        <input type="radio" id="star4" name="review-rating" value="4" /><label for="star4"><i data-lucide="star" class="w-6 h-6"></i></label>
                        <input type="radio" id="star3" name="review-rating" value="3" /><label for="star3"><i data-lucide="star" class="w-6 h-6"></i></label>
                        <input type="radio" id="star2" name="review-rating" value="2" /><label for="star2"><i data-lucide="star" class="w-6 h-6"></i></label>
                        <input type="radio" id="star1" name="review-rating" value="1" /><label for="star1"><i data-lucide="star" class="w-6 h-6"></i></label>
                    </div>
                </div>

                <!-- Name -->
                <div class="mb-4">
                    <label for="review-name" class="block text-sm font-medium text-white/70 mb-2">Your Name / Alias</label>
                    <input type="text" id="review-name" required placeholder="John Doe or Traveler77"
                           class="w-full p-3 bg-white/10 border border-white/20 rounded-md text-white placeholder-white/50 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500" />
                </div>
                
                <!-- Review Text -->
                <div class="mb-6">
                    <label for="review-text" class="block text-sm font-medium text-white/70 mb-2">Your Review</label>
                    <textarea id="review-text" rows="4" required placeholder="Describe your experience: What did you love most?"
                              class="w-full p-3 bg-white/10 border border-white/20 rounded-md text-white placeholder-white/50 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500"></textarea>
                </div>
                
                <button type="submit" id="submit-review-btn" class="w-full py-3 bg-yellow-600 text-black font-bold rounded-sm uppercase tracking-widest text-sm hover:bg-yellow-500 transition duration-300">
                    Share Experience
                </button>
            </form>
        </div>
    </div>


    <!-- Navigation -->
    <nav class="fixed w-full z-50 transition-all duration-300 glass-panel border-b-0" id="navbar">
        <div class="max-w-7xl mx-auto px-6">
            <!-- ADJUSTED: The height of the navbar has been reduced to h-20 (80px) -->
            <div class="flex justify-between items-center h-20">
                <div class="flex-shrink-0 flex items-center cursor-pointer group" onclick="showHome()">
                    <!-- Reduced padding around the icon -->
                    <div class="border border-yellow-600/30 p-1.5 rounded-full mr-3 group-hover:border-yellow-500 transition duration-500">
                        <i data-lucide="palmtree" class="h-5 w-5 text-yellow-500"></i>
                    </div>
                    <div>
                        <span class="block font-bold text-xl tracking-widest text-white serif uppercase leading-none">Kerala</span>
                        <span class="block text-[10px] text-yellow-500 tracking-[0.3em] uppercase mt-1">Tourism</span>
                    </div>
                </div>
                <div class="hidden md:flex space-x-12">
                    <button onclick="showHome()" class="text-gray-300 hover:text-yellow-400 text-sm tracking-widest uppercase transition-colors duration-300 relative group">
                        Home
                        <span class="absolute -bottom-2 left-0 w-0 h-0.5 bg-yellow-500 transition-all duration-300 group-hover:w-full"></span>
                    </button>
                    <button onclick="scrollToSection('districts')" class="text-gray-300 hover:text-yellow-400 text-sm tracking-widest uppercase transition-colors duration-300 relative group">
                        Districts
                        <span class="absolute -bottom-2 left-0 w-0 h-0.5 bg-yellow-500 transition-all duration-300 group-hover:w-full"></span>
                    </button>
                    <button onclick="scrollToSection('itinerary')" class="text-gray-300 hover:text-yellow-400 text-sm tracking-widest uppercase transition-colors duration-300 relative group">
                        Itinerary
                        <span class="absolute -bottom-2 left-0 w-0 h-0.5 bg-yellow-500 transition-all duration-300 group-hover:w-full"></span>
                    </button>
                    <button onclick="scrollToSection('reviews')" class="text-gray-300 hover:text-yellow-400 text-sm tracking-widest uppercase transition-colors duration-300 relative group">
                        Reviews
                        <span class="absolute -bottom-2 left-0 w-0 h-0.5 bg-yellow-500 transition-all duration-300 group-hover:w-full"></span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- HOME VIEW -->
    <div id="home-view" class="view-section active">
        
        <!-- Hero Section -->
        <div class="relative min-h-screen flex items-center justify-center overflow-hidden pt-20">
            <div class="absolute inset-0 z-0">
                <!-- Using a gradient overlay on top of the 3D canvas -->
                <div class="absolute inset-0 bg-gradient-to-t from-[#0b3d2e] via-transparent to-transparent opacity-90"></div>
            </div>
            
            <div class="relative z-10 text-center px-4 max-w-5xl mx-auto">
                <div class="inline-block mb-4 floating-element">
                    <span class="px-4 py-2 border border-yellow-500/30 rounded-full text-yellow-400 text-xs tracking-[0.2em] uppercase bg-black/20 backdrop-blur-sm">
                        Welcome to Paradise
                    </span>
                </div>
                <h1 class="text-6xl md:text-9xl font-thin text-white mb-6 leading-none reveal-on-scroll">
                    <span class="block text-3xl md:text-5xl italic text-yellow-500/80 mb-0 font-light script-font">God's Own</span>
                    Country
                </h1>
                
                <div class="h-px w-32 bg-gradient-to-r from-transparent via-yellow-500 to-transparent mx-auto my-8 opacity-60"></div>

                <p class="text-lg md:text-xl text-gray-300 mb-12 max-w-2xl mx-auto font-light leading-relaxed reveal-on-scroll" style="transition-delay: 0.2s;">
                    Where the mist meets the mountains and the backwaters whisper ancient tales. Experience the soul of nature in 3D.
                </p>
                
                <div class="flex flex-col md:flex-row gap-6 justify-center items-center reveal-on-scroll" style="transition-delay: 0.4s;">
                    <button onclick="scrollToSection('districts')" class="px-10 py-4 bg-yellow-600 text-white rounded-sm font-medium tracking-widest uppercase text-xs hover:bg-yellow-700 transition shadow-[0_0_20px_rgba(202,138,4,0.3)] duration-500">
                        Explore 14 Districts
                    </button>
                    <button onclick="scrollToSection('itinerary')" class="px-10 py-4 border border-white/20 text-white rounded-sm font-medium tracking-widest uppercase text-xs hover:bg-white/5 transition hover:border-white/40 duration-500 flex items-center gap-3">
                        <i data-lucide="map" class="w-4 h-4"></i> View Trip Plan
                    </button>
                </div>
            </div>
            
            <!-- Scroll Indicator -->
            <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce opacity-50">
                <i data-lucide="chevron-down" class="w-6 h-6 text-yellow-500"></i>
            </div>
        </div>

        <!-- Districts Section -->
        <section id="districts" class="py-32 relative z-10">
            <div class="max-w-7xl mx-auto px-6">
                <div class="text-center mb-24 reveal-on-scroll">
                    <h2 class="text-5xl md:text-6xl text-white mb-6">The 14 Jewels of Kerala</h2>
                    <p class="text-yellow-500/80 italic text-2xl script-font">Discover the distinct soul of every region</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-12" id="districts-grid">
                    <!-- Cards Injected via JS -->
                </div>
            </div>
        </section>

        <!-- Itinerary Section -->
        <section id="itinerary" class="py-32 relative z-10 bg-black/20">
            <div class="max-w-5xl mx-auto px-6">
                <div class="glass-panel p-12 md:p-16 rounded-2xl reveal-on-scroll relative overflow-hidden">
                    <!-- Decorative Elements -->
                    <div class="absolute top-0 right-0 w-64 h-64 bg-yellow-500/5 rounded-full blur-3xl -mr-32 -mt-32"></div>
                    <div class="absolute bottom-0 left-0 w-64 h-64 bg-green-500/5 rounded-full blur-3xl -ml-32 -mb-32"></div>

                    <div class="text-center mb-16 relative z-10">
                        <span class="text-yellow-500 text-xs tracking-[0.3em] uppercase mb-4 block">Recommended Journey</span>
                        <h2 class="text-4xl md:text-5xl text-white mb-6 serif">Thrissur to Munnar Escape</h2>
                        <div class="flex justify-center items-center gap-4 text-gray-400 text-sm">
                            <span class="flex items-center gap-2"><i data-lucide="calendar" class="w-4 h-4"></i> 3 Days</span>
                            <span class="w-1 h-1 bg-gray-600 rounded-full"></span>
                            <span class="flex items-center gap-2"><i data-lucide="car" class="w-4 h-4"></i> Road Trip</span>
                        </div>
                    </div>

                    <div class="space-y-12 relative z-10 border-l border-white/10 ml-4 md:ml-0 md:border-none">
                        <!-- Day 1 -->
                        <div class="grid md:grid-cols-[100px_1fr] gap-8 relative group">
                            <div class="hidden md:flex flex-col items-center">
                                <span class="text-4xl font-bold text-yellow-500/20 group-hover:text-yellow-500 transition duration-500">01</span>
                                <div class="h-full w-px bg-white/10 mt-4 group-hover:bg-yellow-500/30 transition duration-500"></div>
                            </div>
                            <div class="pl-8 md:pl-0 relative">
                                <div class="absolute left-[-5px] top-2 w-2.5 h-2.5 bg-yellow-500 rounded-full md:hidden"></div>
                                <h3 class="text-2xl text-white mb-2 serif">The Scenic Drive Begins</h3>
                                <p class="text-yellow-500/80 text-sm mb-4">Thrissur ➔ Cheeyappara Waterfalls ➔ Munnar</p>
                                <p class="text-gray-400 leading-relaxed mb-4 text-sm font-light">
                                    Start early (7:00 AM) via NH544. Stop at Valara Waterfalls for photos. Visit the Spice Gardens en route. Check-in at Munnar by 1:30 PM. Evening tea at the Tata Tea Museum.
                                </p>
                            </div>
                        </div>

                        <!-- Day 2 -->
                        <div class="grid md:grid-cols-[100px_1fr] gap-8 relative group">
                            <div class="hidden md:flex flex-col items-center">
                                <span class="text-4xl font-bold text-yellow-500/20 group-hover:text-yellow-500 transition duration-500">02</span>
                                <div class="h-full w-px bg-white/10 mt-4 group-hover:bg-yellow-500/30 transition duration-500"></div>
                            </div>
                            <div class="pl-8 md:pl-0 relative">
                                <div class="absolute left-[-5px] top-2 w-2.5 h-2.5 bg-yellow-500 rounded-full md:hidden"></div>
                                <h3 class="text-2xl text-white mb-2 serif">Misty Mountains & Lakes</h3>
                                <p class="text-yellow-500/80 text-sm mb-4">Eravikulam National Park ➔ Mattupetty Dam</p>
                                <p class="text-gray-400 leading-relaxed mb-4 text-sm font-light">
                                    Morning safari at Eravikulam to see Nilgiri Tahr. Afternoon boating at Mattupetty Dam. Listen to your voice return at Echo Point.
                                </p>
                            </div>
                        </div>

                        <!-- Day 3 -->
                        <div class="grid md:grid-cols-[100px_1fr] gap-8 relative group">
                            <div class="hidden md:flex flex-col items-center">
                                <span class="text-4xl font-bold text-yellow-500/20 group-hover:text-yellow-500 transition duration-500">03</span>
                            </div>
                            <div class="pl-8 md:pl-0 relative">
                                <div class="absolute left-[-5px] top-2 w-2.5 h-2.5 bg-yellow-500 rounded-full md:hidden"></div>
                                <h3 class="text-2xl text-white mb-2 serif">The Descent</h3>
                                <p class="text-yellow-500/80 text-sm mb-4">Top Station ➔ Return to Thrissur</p>
                                <p class="text-gray-400 leading-relaxed mb-4 text-sm font-light">
                                    Catch the sunrise at Top Station. Visit Attukal Waterfalls if time permits. Lunch at Adimali before heading back.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reviews Section -->
        <section id="reviews" class="py-32 relative z-10">
            <div class="max-w-5xl mx-auto px-6">
                <div class="text-center mb-16 reveal-on-scroll">
                    <span class="text-yellow-500 text-xs tracking-[0.3em] uppercase mb-4 block">Community Feedback</span>
                    <h2 class="text-4xl md:text-5xl text-white mb-6 serif">Guest Experiences</h2>
                    <p class="text-gray-400 max-w-xl mx-auto font-light">
                        Share your journey with the world. Your review helps fellow travellers discover the best of Kerala.
                    </p>
                </div>

                <div class="glass-panel p-10 rounded-2xl reveal-on-scroll border border-yellow-500/10">
                    
                    <!-- Average Rating Display -->
                    <div class="flex flex-col sm:flex-row items-center justify-between mb-8 p-4 bg-white/5 rounded-xl border border-white/10">
                        <div class="flex items-center mb-4 sm:mb-0">
                            <i data-lucide="star" class="w-8 h-8 text-yellow-500 fill-yellow-500/20 mr-4"></i>
                            <div class="text-left">
                                <p class="text-3xl font-bold text-white serif" id="average-rating">0.0 / 5.0</p>
                                <div class="flex gap-1 mb-1" id="average-stars">
                                    <!-- Stars rendered by JS -->
                                </div>
                                <p class="text-sm text-gray-400" id="review-count">Loading reviews...</p>
                            </div>
                        </div>
                        <button id="write-review-btn" disabled onclick="openReviewModal()" class="px-6 py-3 bg-yellow-600 text-black font-medium rounded-sm shadow-md hover:bg-yellow-700 transition duration-300 uppercase text-xs tracking-widest disabled:opacity-50">
                            Write a Review
                        </button>
                    </div>

                    <!-- Review List Container -->
                    <div id="review-list-container">
                        <div class="text-center p-12 border-4 border-dashed border-white/10 rounded-xl bg-black/10">
                            <i data-lucide="message-square" class="w-16 h-16 text-yellow-500/40 mx-auto mb-4 animate-pulse"></i>
                            <h3 class="text-2xl text-white mb-2 serif">Loading Reviews...</h3>
                            <p class="text-gray-400 text-sm">Connecting to the experience network.</p>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- Footer - UPDATED WITH SOCIAL LINKS -->
        <footer class="py-12 border-t border-white/5 text-center relative z-10">
            <div class="max-w-7xl mx-auto px-6">
                <div class="flex flex-col items-center">
                    <!-- Social Links -->
                    <div class="flex space-x-6 mb-6">
                        <a href="https://www.instagram.com/imnashvan" target="_blank" class="text-white/50 hover:text-yellow-500 transition duration-300 p-3 rounded-full border border-white/10 hover:border-yellow-500/50">
                            <i class="fab fa-instagram text-xl"></i>
                        </a>
                        <a href="https://t.me/+918606002154" target="_blank" class="text-white/50 hover:text-yellow-500 transition duration-300 p-3 rounded-full border border-white/10 hover:border-yellow-500/50">
                            <i class="fab fa-telegram-plane text-xl"></i>
                        </a>
                        <a href="https://wa.me/+918606002154" target="_blank" class="text-white/50 hover:text-yellow-500 transition duration-300 p-3 rounded-full border border-white/10 hover:border-yellow-500/50">
                            <i class="fab fa-whatsapp text-xl"></i>
                        </a>
                    </div>
                    <!-- Copyright -->
                    <p class="text-white/30 text-xs tracking-widest uppercase">© 2024 Kerala Tourism Places</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- DISTRICT DETAIL VIEW -->
    <div id="detail-view" class="view-section min-h-screen relative z-20">
        <div class="absolute inset-0 bg-[#0b3d2e] bg-opacity-95 backdrop-blur-xl z-0"></div>
        
        <div class="relative z-10">
            <!-- Header -->
            <div class="flex justify-between items-center p-8 border-b border-white/10">
                <button onclick="showHome()" class="flex items-center gap-3 text-white/60 hover:text-yellow-500 transition group">
                    <div class="border border-white/20 p-2 rounded-full group-hover:border-yellow-500 transition">
                        <i data-lucide="arrow-left" class="w-4 h-4"></i>
                    </div>
                    <span class="text-xs uppercase tracking-widest">Return</span>
                </button>
                <div class="text-right">
                    <h2 id="detail-title" class="text-3xl font-serif text-white">District</h2>
                    <p id="detail-tagline" class="text-yellow-500 text-sm italic script-font text-xl"></p>
                </div>
            </div>

            <div class="max-w-6xl mx-auto px-6 py-12">
                <div class="grid lg:grid-cols-2 gap-16">
                    <!-- Left: Content -->
                    <div class="space-y-12">
                        <div>
                            <span class="text-yellow-500/50 text-[10px] uppercase tracking-[0.3em] block mb-4">Overview</span>
                            <p id="detail-desc" class="text-gray-300 text-lg font-light leading-8"></p>
                        </div>
                        
                        <div class="gold-divider"></div>
                        
                        <div>
                            <h3 class="text-2xl text-white mb-8 serif">Famous Attractions</h3>
                            <div id="attractions-list" class="space-y-6">
                                <!-- Attractions injected here -->
                            </div>
                        </div>
                        
                        <!-- Info Grid -->
                        <div class="grid grid-cols-2 gap-6">
                            <div class="bg-white/5 p-6 border border-white/10 rounded-sm">
                                <span class="block text-yellow-500/70 text-xs uppercase mb-2">Best Time</span>
                                <span id="detail-time" class="text-white text-lg serif"></span>
                            </div>
                            <div class="bg-white/5 p-6 border border-white/10 rounded-sm">
                                <span class="block text-yellow-500/70 text-xs uppercase mb-2">Nearest Airport</span>
                                <span id="detail-airport" class="text-white text-lg serif"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Camera/Interactive -->
                    <div class="relative">
                        <div class="sticky top-12">
                            <div class="glass-panel p-8 rounded-2xl border border-yellow-500/20 shadow-2xl relative overflow-hidden">
                                <!-- Background Glow -->
                                <div class="absolute inset-0 bg-gradient-to-br from-yellow-500/10 to-transparent opacity-50"></div>
                                
                                <div class="relative z-10 text-center">
                                    <div class="w-16 h-16 bg-gradient-to-tr from-yellow-600 to-yellow-400 rounded-full mx-auto flex items-center justify-center mb-6 shadow-lg shadow-yellow-900/50 floating-element">
                                        <i data-lucide="camera" class="w-8 h-8"></i>
                                    </div>
                                    <h3 class="text-2xl text-white mb-2 serif">Capture Memories</h3>
                                    <p class="text-white/60 text-sm mb-8 font-light">Upload your photo to generate a custom digital postcard from this district.</p>
                                    
                                    <!-- Hidden Input -->
                                    <input type="file" id="cameraInput" accept="image/*" class="hidden" onchange="handleImageUpload(event)">
                                    
                                    <button onclick="document.getElementById('cameraInput').click()" class="w-full py-4 border border-yellow-500 text-yellow-500 hover:bg-yellow-500 hover:text-black hover:border-yellow-500 transition duration-500 uppercase text-xs tracking-widest font-bold mb-8">
                                        Open Camera / Upload
                                    </button>
                                    
                                    <!-- Preview Frame -->
                                    <div id="preview-frame" class="bg-white p-4 pb-12 shadow-2xl transform rotate-2 transition duration-500 hover:rotate-0 hidden">
                                        <div class="bg-gray-100 aspect-[4/3] overflow-hidden relative">
                                            <img id="user-preview" class="w-full h-full object-cover">
                                            <div class="absolute bottom-2 right-2 flex gap-1">
                                                <div class="w-2 h-2 rounded-full bg-red-500"></div>
                                                <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                                                <div class="w-2 h-2 rounded-full bg-green-500"></div>
                                            </div>
                                        </div>
                                        <div class="mt-4 text-left">
                                            <p class="text-black font-serif text-xl italic" id="preview-caption">Greetings from Kerala</p>
                                            <p class="text-gray-400 text-[10px] uppercase tracking-widest mt-1">God's Own Country</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // --- 1. DATA: THE 14 DISTRICTS ---
        const districts = [
            { id: 'tvm', name: 'Thiruvananthapuram', tagline: 'The Evergreen City', desc: 'The capital city built on seven hills. It blends heritage with urban life, featuring historic temples, colonial museums, and the famous Kovalam coastline.', attractions: ['Padmanabhaswamy Temple', 'Kovalam Beach', 'Napier Museum'], time: 'Oct - Feb', airport: 'Trivandrum Intl' },
            { id: 'klm', name: 'Kollam', tagline: 'Prince of Arabian Sea', desc: 'An ancient trading port known for its cashew industry and the gateway to the backwaters via Ashtamudi Lake.', attractions: ['Jatayu Earth Center', 'Ashtamudi Lake', 'Thangassery Light House'], time: 'Aug - Mar', airport: 'Trivandrum (60km)' },
            { id: 'ptm', name: 'Pathanamthitta', tagline: 'Pilgrim Capital', desc: 'A spiritual headquarters surrounded by pristine forests, home to the sacred Sabarimala shrine and eco-tourism spots.', attractions: ['Sabarimala Temple', 'Gavi Forests', 'Konni Elephant Camp'], time: 'Nov - Jan', airport: 'Trivandrum (100km)' },
            { id: 'alp', name: 'Alappuzha', tagline: 'Venice of the East', desc: 'World-renowned for its intricate network of backwaters, houseboat cruises, and the annual snake boat races.', attractions: ['Houseboat Cruise', 'Alappuzha Beach', 'Kuttanad Fields'], time: 'Nov - Feb', airport: 'Cochin (85km)' },
            { id: 'ktm', name: 'Kottayam', tagline: 'Land of Letters', desc: 'A center of literature and lakes, bordered by the Western Ghats on the east and the Vembanad Lake and paddy fields of Kuttanad on the west.', attractions: ['Kumarakom', 'Illickal Kallu', 'Thirunakkara Temple'], time: 'Sep - Mar', airport: 'Cochin (90km)' },
            { id: 'idk', name: 'Idukki', tagline: 'Spice Garden', desc: 'A rugged hill district with massive arch dams, wildlife sanctuaries, and the tea plantations of Munnar.', attractions: ['Munnar Tea Gardens', 'Idukki Arch Dam', 'Meesapulimala'], time: 'Sep - Mar', airport: 'Cochin (110km)' },
            { id: 'ekm', name: 'Ernakulam', tagline: 'The Commercial Queen', desc: 'Home to Kochi, a cosmopolitan hub with deep colonial roots, Chinese fishing nets, and modern shopping malls.', attractions: ['Fort Kochi', 'Marine Drive', 'Mattancherry Palace'], time: 'All Year', airport: 'Cochin Intl' },
            { id: 'tcr', name: 'Thrissur', tagline: 'Cultural Capital', desc: 'Famous for the majestic Thrissur Pooram festival, ancient temples, and the magnificent Athirappilly waterfalls.', attractions: ['Athirappilly Falls', 'Vadakkunnathan Temple', 'Thrissur Zoo'], time: 'Oct - Mar', airport: 'Cochin (55km)' },
            { id: 'pkd', name: 'Palakkad', tagline: 'Granary of Kerala', desc: 'A gap in the Western Ghats known for its paddy fields, historical forts, and the untouched Silent Valley National Park.', attractions: ['Palakkad Fort', 'Silent Valley', 'Malampuzha Dam'], time: 'Nov - Mar', airport: 'Coimbatore (55km)' },
            { id: 'mlp', name: 'Malappuram', tagline: 'Soccer Capital', desc: 'A district with a rich history, famous for its teak plantations in Nilambur and a passionate love for football.', attractions: ['Nilambur Teak Museum', 'Kottakkunnu', 'Adyanpara Falls'], time: 'Sep - Mar', airport: 'Calicut Intl' },
            { id: 'kzk', name: 'Kozhikode', tagline: 'City of Spices', desc: 'A historic port city where Vasco da Gama landed. Famous for its authentic Malabar cuisine (Biryani/Halwa) and beaches.', attractions: ['Kappad Beach', 'Mananchira Square', 'Beypore Beach'], time: 'Sep - Mar', airport: 'Calicut Intl' },
            { id: 'wyd', name: 'Wayanad', tagline: 'Green Paradise', desc: 'A bio-diverse hill station known for its camping sites, caves, waterfalls, and spice plantations.', attractions: ['Edakkal Caves', 'Banasura Sagar Dam', 'Chembra Peak'], time: 'Oct - May', airport: 'Calicut (90km)' },
            { id: 'knr', name: 'Kannur', tagline: 'Land of Looms', desc: 'Known for its ritualistic Theyyam art form, handloom industry, and pristine drive-in beaches.', attractions: ['Muzhappilangad Beach', 'St. Angelo Fort', 'Theyyam Performances'], time: 'Oct - Mar', airport: 'Kannur Intl' },
            { id: 'ksd', name: 'Kasaragod', tagline: 'Land of Gods', desc: 'The northernmost district, home to the imposing Bekal Fort and distinctive linguistic culture.', attractions: ['Bekal Fort', 'Ananthapura Lake Temple', 'Ranipuram Peak'], time: 'Sep - Mar', airport: 'Mangalore (50km)' }
        ];

        // --- 2. FIREBASE & AUTH GLOBAL VARIABLES ---
        let app, db, auth;
        let userId = null;
        let isAuthReady = false;

        async function initFirebaseAndAuth() {
            try {
                // Global variables provided by the environment
                const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

                if (Object.keys(firebaseConfig).length === 0 || !appId) {
                    console.error("Firebase configuration or App ID is missing. Persistence disabled.");
                    isAuthReady = true;
                    document.getElementById('review-count').innerText = "Persistence disabled.";
                    document.getElementById('write-review-btn').disabled = true;
                    return;
                }

                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

                // Sign in using the custom token or anonymously if not available
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                userId = auth.currentUser?.uid || crypto.randomUUID();
                isAuthReady = true;
                
                // Start listening for reviews immediately after auth
                listenForReviews(appId);
                document.getElementById('write-review-btn').disabled = false;

            } catch (error) {
                console.error("Firebase initialization or authentication failed:", error);
                isAuthReady = true;
                document.getElementById('review-count').innerText = "Failed to load reviews.";
            }
        }
        
        // --- 3. REVIEWS LOGIC ---

        function listenForReviews(appId) {
            if (!db || !appId) return;

            // Public data path for shared reviews: /artifacts/{appId}/public/data/reviews
            const reviewsPath = `/artifacts/${appId}/public/data/reviews`;
            const q = query(collection(db, reviewsPath));
            
            // Real-time listener
            onSnapshot(q, (snapshot) => {
                let totalRating = 0;
                const reviews = [];

                snapshot.forEach((doc) => {
                    const data = doc.data();
                    if (data.rating) { // Only count valid reviews
                        reviews.push({ id: doc.id, ...data });
                        totalRating += data.rating;
                    }
                });

                // Sort by timestamp descending (newest first)
                reviews.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));

                const averageRating = reviews.length > 0 ? (totalRating / reviews.length).toFixed(1) : '0.0';
                
                renderReviews(reviews, averageRating);

            }, (error) => {
                console.error("Error listening to reviews:", error);
            });
        }
        
        function renderReviews(reviews, averageRating) {
            const reviewListContainer = document.getElementById('review-list-container');
            const averageRatingDisplay = document.getElementById('average-rating');
            const reviewCountDisplay = document.getElementById('review-count');
            const starContainer = document.getElementById('average-stars');
            
            // Update Summary
            averageRatingDisplay.innerText = `${averageRating} / 5.0`;
            reviewCountDisplay.innerText = reviews.length > 0 ? `${reviews.length} total reviews` : `Be the first to rate us`;
            
            // Render Stars
            starContainer.innerHTML = '';
            const ratingValue = parseFloat(averageRating);
            const fullStars = Math.floor(ratingValue);
            
            for(let i=1; i<=5; i++) {
                let colorClass = 'text-white/30';
                if (i <= fullStars) {
                    colorClass = 'text-yellow-500 fill-yellow-500';
                }
                // Note: Implementing half stars properly requires custom SVG or complex masking. Using full/empty for simplicity.
                starContainer.innerHTML += `<i data-lucide="star" class="w-4 h-4 ${colorClass}"></i>`;
            }
            lucide.createIcons();

            // Render List
            if (reviews.length === 0) {
                reviewListContainer.innerHTML = `
                    <div class="text-center p-12 border-4 border-dashed border-white/10 rounded-xl bg-black/10">
                        <i data-lucide="message-square" class="w-16 h-16 text-yellow-500/40 mx-auto mb-4"></i>
                        <h3 class="text-2xl text-white mb-2 serif">No Voices Yet</h3>
                        <p class="text-gray-400 text-sm">This space awaits your valuable thoughts and travel insights.</p>
                    </div>
                `;
            } else {
                reviewListContainer.innerHTML = reviews.map(r => `
                    <div class="glass-card p-6 rounded-xl border border-white/10 mb-6">
                        <div class="flex justify-between items-start mb-3">
                            <p class="font-bold text-yellow-400">${r.name || 'Anonymous Traveler'}</p>
                            <div class="flex gap-1">
                                ${Array(5).fill(0).map((_, i) => `
                                    <i data-lucide="star" class="w-4 h-4 ${i < r.rating ? 'fill-yellow-500 text-yellow-500' : 'text-white/30'}"></i>
                                `).join('')}
                            </div>
                        </div>
                        <p class="text-sm text-gray-300 leading-relaxed">${r.reviewText}</p>
                        <p class="text-xs text-white/50 mt-2">${r.timestamp ? new Date(r.timestamp.seconds * 1000).toLocaleDateString() : 'N/A'}</p>
                    </div>
                `).join('');
                lucide.createIcons();
            }
        }

        async function submitReview() {
            if (!isAuthReady || !db) {
                showMessage("Service not ready. Please wait for initialization.", 'red');
                return;
            }

            const name = document.getElementById('review-name').value.trim();
            const ratingInput = document.querySelector('input[name="review-rating"]:checked');
            const rating = ratingInput ? parseInt(ratingInput.value) : null;
            const reviewText = document.getElementById('review-text').value.trim();

            if (!name || !rating || !reviewText) {
                showMessage("Please fill out your name, select a rating, and write your review.", 'yellow');
                return;
            }

            const submitBtn = document.getElementById('submit-review-btn');
            submitBtn.disabled = true;
            submitBtn.innerText = 'Submitting...';

            try {
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const reviewsPath = `/artifacts/${appId}/public/data/reviews`;

                await addDoc(collection(db, reviewsPath), {
                    name: name,
                    rating: rating,
                    reviewText: reviewText,
                    userId: userId,
                    timestamp: serverTimestamp(),
                });

                showMessage("Thank you! Your review has been shared.", 'green');
                closeReviewModal();
            } catch (error) {
                console.error("Error adding document: ", error);
                showMessage("Failed to submit review. Please try again.", 'red');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerText = 'Share Experience';
            }
        }
        
        // Expose submitReview globally for the form
        window.submitReview = submitReview;

        function openReviewModal() {
            document.getElementById('review-modal').classList.remove('hidden');
            document.getElementById('review-modal').classList.add('flex');
            // Reset message box
            const msgBox = document.getElementById('message-box');
            msgBox.innerHTML = '';
            msgBox.classList.add('hidden');
        }
        window.openReviewModal = openReviewModal;

        function closeReviewModal() {
            document.getElementById('review-modal').classList.add('hidden');
            document.getElementById('review-modal').classList.remove('flex');
            document.getElementById('review-form').reset();
        }
        window.closeReviewModal = closeReviewModal;
        
        function showMessage(message, type) {
            const msgBox = document.getElementById('message-box');
            let colorClass;
            
            switch(type) {
                case 'green': colorClass = 'bg-green-600/20 text-green-300 border-green-500/50'; break;
                case 'red': colorClass = 'bg-red-600/20 text-red-300 border-red-500/50'; break;
                case 'yellow': default: colorClass = 'bg-yellow-600/20 text-yellow-300 border-yellow-500/50'; break;
            }

            msgBox.className = `p-3 rounded-lg border text-sm mb-4 ${colorClass}`;
            msgBox.innerHTML = message;
            msgBox.classList.remove('hidden');
        }


        // --- 4. INITIALIZATION & UTILITIES ---
        window.onload = function() {
            initThreeJS();
            renderDistricts();
            lucide.createIcons();
            initObserver();
            initFirebaseAndAuth();
        };

        function renderDistricts() {
            const grid = document.getElementById('districts-grid');
            grid.innerHTML = districts.map(d => `
                <div class="glass-card p-8 rounded-sm text-center district-card cursor-pointer group relative overflow-hidden reveal-on-scroll" onclick="openDistrict('${d.id}')">
                    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-yellow-500 to-transparent transform scale-x-0 group-hover:scale-x-100 transition duration-700"></div>
                    
                    <!-- Beautiful Font for District Name -->
                    <h3 class="district-name-art text-5xl mb-2">${d.name}</h3>
                    <p class="text-white/40 text-xs uppercase tracking-widest mb-6 group-hover:text-yellow-500 transition">${d.tagline}</p>
                    
                    <div class="w-8 h-px bg-white/10 mx-auto mb-6"></div>
                    
                    <p class="text-gray-400 text-sm font-light leading-relaxed mb-8 line-clamp-2">${d.desc}</p>
                    
                    <span class="inline-block px-6 py-2 border border-white/10 text-white/60 text-[10px] uppercase tracking-widest hover:bg-yellow-500 hover:text-black hover:border-yellow-500 transition duration-300">
                        Discover
                    </span>
                </div>
            `).join('');
            lucide.createIcons();
        }

        // --- 5. NAVIGATION ---
        function showHome() {
            const overlay = document.getElementById('transition-overlay');
            overlay.classList.add('active');

            // NEW: Show Navbar
            document.getElementById('navbar').style.opacity = '1';
            document.getElementById('navbar').style.pointerEvents = 'auto';
            
            setTimeout(() => {
                document.getElementById('detail-view').classList.remove('active');
                document.getElementById('home-view').classList.add('active');
                window.scrollTo(0, 0);
                setTimeout(() => overlay.classList.remove('active'), 500);
            }, 800);
        }
        window.showHome = showHome;

        function scrollToSection(id) {
            if(document.getElementById('home-view').classList.contains('active')) {
                document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
            } else {
                showHome();
                // Wait for the transition out to complete before attempting to scroll
                setTimeout(() => document.getElementById(id).scrollIntoView({ behavior: 'smooth' }), 1000);
            }
        }
        window.scrollToSection = scrollToSection;

        function openDistrict(id) {
            const d = districts.find(x => x.id === id);
            if(!d) return;

            // NEW: Hide Navbar (smoother transition than class 'hidden')
            document.getElementById('navbar').style.opacity = '0';
            document.getElementById('navbar').style.pointerEvents = 'none';

            // Fill Data
            document.getElementById('detail-title').innerText = d.name;
            document.getElementById('detail-tagline').innerText = d.tagline;
            document.getElementById('detail-desc').innerText = d.desc;
            document.getElementById('detail-time').innerText = d.time;
            document.getElementById('detail-airport').innerText = d.airport;
            document.getElementById('preview-caption').innerText = "Greetings from " + d.name;

            // Fill Attractions
            document.getElementById('attractions-list').innerHTML = d.attractions.map(attr => `
                <div class="flex items-center gap-4 group">
                    <div class="w-10 h-10 border border-white/10 flex items-center justify-center rounded-full group-hover:border-yellow-500 transition">
                        <i data-lucide="map-pin" class="w-4 h-4 text-yellow-500"></i>
                    </div>
                    <span class="text-white font-light text-lg group-hover:translate-x-2 transition duration-300">${attr}</span>
                </div>
            `).join('');
            lucide.createIcons();

            // Transition
            const overlay = document.getElementById('transition-overlay');
            overlay.classList.add('active');
            
            setTimeout(() => {
                document.getElementById('home-view').classList.remove('active');
                document.getElementById('detail-view').classList.add('active');
                window.scrollTo(0, 0);
                
                // Reset Camera preview
                document.getElementById('preview-frame').classList.add('hidden');
                
                setTimeout(() => overlay.classList.remove('active'), 500);
            }, 800);
        }
        window.openDistrict = openDistrict;

        // --- 6. CAMERA LOGIC ---
        function handleImageUpload(e) {
            const file = e.target.files[0];
            if(file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = document.getElementById('user-preview');
                    img.src = event.target.result;
                    document.getElementById('preview-frame').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }
        window.handleImageUpload = handleImageUpload;

        // --- 7. ANIMATION OBSERVER (for reveal-on-scroll) ---
        function initObserver() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if(entry.isIntersecting) {
                        entry.target.classList.add('reveal-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.reveal-on-scroll').forEach(el => observer.observe(el));
        }

        // --- 8. THREE.JS FIREFLIES BACKGROUND (Optimized for stability) ---
        function initThreeJS() {
            const container = document.getElementById('canvas-container');
            const scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x0b3d2e, 0.003); 

            const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 250;

            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);

            const count = 500;
            const positions = new Float32Array(count * 3);
            const velocities = [];

            for (let i = 0; i < count; i++) {
                positions[i * 3 + 0] = (Math.random() * 2 - 1) * 400;
                positions[i * 3 + 1] = (Math.random() * 2 - 1) * 400;
                positions[i * 3 + 2] = (Math.random() * 2 - 1) * 400;

                velocities.push(
                    (Math.random() - 0.5) * 0.1, 
                    (Math.random() - 0.5) * 0.1, 
                    (Math.random() - 0.5) * 0.1  
                );
            }

            const geometry = new THREE.BufferGeometry();
            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            
            const getTexture = () => {
                const canvas = document.createElement('canvas');
                canvas.width = 32; canvas.height = 32;
                const ctx = canvas.getContext('2d');
                const grad = ctx.createRadialGradient(16,16,0,16,16,16);
                grad.addColorStop(0, 'rgba(255, 230, 100, 1)');
                grad.addColorStop(0.4, 'rgba(100, 255, 100, 0.5)');
                grad.addColorStop(1, 'rgba(0,0,0,0)');
                ctx.fillStyle = grad;
                ctx.fillRect(0,0,32,32);
                const tex = new THREE.Texture(canvas);
                tex.needsUpdate = true;
                return tex;
            };

            const material = new THREE.PointsMaterial({
                size: 3,
                map: getTexture(),
                transparent: true,
                opacity: 0.8,
                depthWrite: false,
                blending: THREE.AdditiveBlending,
                color: 0xccffaa 
            });

            const particles = new THREE.Points(geometry, material);
            scene.add(particles);

            function animate() {
                requestAnimationFrame(animate);

                const positions = particles.geometry.attributes.position.array;
                
                for(let i = 0; i < count; i++) {
                    const i3 = i * 3;
                    
                    positions[i3 + 0] += velocities[i * 3 + 0];
                    positions[i3 + 1] += velocities[i * 3 + 1];
                    positions[i3 + 2] += velocities[i * 3 + 2];
                    
                    if (positions[i3 + 0] > 400) positions[i3 + 0] = -400;
                    if (positions[i3 + 0] < -400) positions[i3 + 0] = 400;
                    if (positions[i3 + 1] > 400) positions[i3 + 1] = -400;
                    if (positions[i3 + 1] < -400) positions[i3 + 1] = 400;
                    if (positions[i3 + 2] > 400) positions[i3 + 2] = -400;
                    if (positions[i3 + 2] < -400) positions[i3 + 2] = 400;
                    
                    velocities[i * 3 + 0] += (Math.random() - 0.5) * 0.005;
                    velocities[i * 3 + 1] += (Math.random() - 0.5) * 0.005;
                    velocities[i * 3 + 2] += (Math.random() - 0.5) * 0.005;
                    
                    velocities[i * 3 + 0] *= 0.99;
                    velocities[i * 3 + 1] *= 0.99;
                    velocities[i * 3 + 2] *= 0.99;
                }
                particles.geometry.attributes.position.needsUpdate = true;

                particles.rotation.y += 0.0005; 
                
                renderer.render(scene, camera);
            }
            animate();

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }
    </script>
</body>
</html>